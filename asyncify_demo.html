<dialog id="promptDialog">
  10 + <input type="number" id="number" /><input
    type="button"
    value="="
    id="closeDialog"
  />
</dialog>

<script type="module">
  const dialogElem = document.getElementById('promptDialog');
  const numberElem = document.getElementById('number');
  const closeDialogElem = document.getElementById('closeDialog');

  closeDialogElem.onclick = () => dialogElem.close();

  function asyncPrompt() {
    return new Promise(resolve => {
      dialogElem.onclose = () => resolve(numberElem.valueAsNumber);
      dialogElem.showModal();
    });
  }

  import { instantiateStreaming } from './asyncify.js';

  (async () => {
    let { instance } = await instantiateStreaming(
      fetch('./asyncify_demo_rs.wasm'),
      {
        env: {
          prompt: asyncPrompt
        }
      }
    );

    console.log(await instance.exports.add(10));
  })();
</script>
